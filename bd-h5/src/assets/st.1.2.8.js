!function(e){var t=+new Date,n={},r={},o=(r.toString,r.hasOwnProperty),i=Object.prototype,a=i.toString,c={raw:!1,json:!1,splitStr:"###"},u=e.location,s={reportedUrl:"http://stat.allpyra.com",img:e.G_REPORT_URL||"/api/pv/pv.jsp",hostName:u.hostname,sessionExpiration:1800};n.isFunction="object"==typeof alert?function(e){try{return/^\s*\bfunction\b/.test(e+"")}catch(t){return!1}}:function(e){return"[object Function]"===a.call(e)},n.isArray=function(e){return e instanceof Array},n.isWindow=function(e){return null!=e&&e===e.window},n.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},n.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?r[a.call(e)]||"object":typeof e},n.isPlainObject=function(e){if("object"!==n.type(e)||e.nodeType||jQuery.isWindow(e))return!1;try{if(e.constructor&&!o.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},n.isArrayLike=function(e){if(!e)return!1;var t=e.length;if(t===t>>>0){var n=a.call(e).slice(8,-1);if(/(?:regexp|string|function|window|global)$/i.test(n))return!1;if("Array"===n)return!0;try{return{}.propertyIsEnumerable.call(e,"length")!==!1||/^\s?function/.test(e.item||e.callee)}catch(r){return!e.window}}return!1},n.each=function(e,t){if(e){var r=0;if(n.isArrayLike(e))for(var o=e.length;r<o&&t(r,e[r])!==!1;r++);else for(r in e)if(e.hasOwnProperty(r)&&t(r,e[r])===!1)break}},n.extend=function(){var e,t,r,o,i,a,c=arguments[0]||{},u=1,s=arguments.length,d=!1;for("boolean"==typeof c&&(d=c,c=arguments[1]||{},u++),"object"==typeof c||n.isFunction(c)||(c={}),u===s&&(c=this,u--);u<s;u++)if(null!=(e=arguments[u]))for(t in e){r=c[t];try{o=e[t]}catch(p){continue}c!==o&&(d&&o&&(n.isPlainObject(o)||(i=Array.isArray(o)))?(i?(i=!1,a=r&&Array.isArray(r)?r:[]):a=r&&n.isPlainObject(r)?r:{},c[t]=n.extend(d,a,o)):void 0!==o&&(c[t]=o))}return c},n.extend({version:"0.01",device:{ba:/msie (\d+\.\d+)/i.test(navigator.userAgent),cookieEnabled:navigator.cookieEnabled,javaEnabled:navigator.javaEnabled(),language:navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||"",screen:(e.screen.width||0)+"*"+(e.screen.height||0),colorDepth:e.screen.colorDepth||0,net:function(){try{return navigator.connection.type}catch(e){return"unknown"}}(),type:function(){function e(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,r=0;r<t.length;r++)if(e.indexOf(t[r])>0){n=!1;break}return n}if(e())return"PC";var t="WAP";return n.each(n.cookie(),function(e,n){if(e.indexOf("_TERMINAL")>-1)return t=n.toUpperCase().indexOf("ANDROID")>-1?"Android":"IOS",!1}),t},appVersion:function(){var e="";return n.each(n.cookie(),function(t,n){if(t.indexOf("_TERMINAL")>-1)return e=n.split(",")[1],!1}),e}},getRandomStr:function(){return String(Math.random()).replace(/\d\.\d{4}/,"")},generateSectionId:function(e){var t=this.getRandomStr;return(t()+t()+t()).substring(0,32)},generateUUID:function(){return"xyxyxxxyxyxxxxxyxxxyxxxxxxxxyxxxxxxyyxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},generateSection:function(){var e=[];return e.push(n.generateSectionId()),e.push(t),e.push(t),e.push("1"),e.join(c.splitStr)},generatePprdByPtag:function(e){var t,r=n.cookie("pprd"),o="",i="";if(e=e||n.url.param("ptag"),r&&function(e){o=e[0]?e[0].replace("OT.",""):"",i=e[1]?e[1].replace("IN.",""):""}(r.split("-")),n.checkPtag(e))switch(n.device.appVersion().length>0&&(e="1"+e.substr(1)),+e.charAt(1)){case 2:o=e;break;case 3:i=e}return t="OT."+o+"-IN."+i},setSessionCookie:function(){n.cookie("session",n.generateSection())},checkSessionCookie:function(e){return n.isArray(e)&&4===e.length&&function(e){return/^st[0-9]{12}$/.test(e[0])&&/^[0-9]{13}$/.test(e[1])&&/^[0-9]{13}$/.test(e[2])&&/\d/.test(e[3])}(e)},checkPtag:function(e){return e&&/^[0-9]+\.[0-9]+\.[0-9]+$/.test(e)},cookie:function(e,t,r){function o(e){return c.raw?e:encodeURIComponent(e)}function i(e){return c.raw?e:decodeURIComponent(e)}function a(e){return o(c.json?JSON.stringify(e):String(e))}function u(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(d," ")),c.json?JSON.parse(e):e}catch(t){}}function s(e,t){var r=c.raw?e:u(e);return n.isFunction(t)?t(r):r}var d=/\+/g;if(arguments.length>1&&!n.isFunction(t)){if(r=n.extend({},{path:"/",expires:90},r),"number"==typeof r.expires){var p=r.expires,f=r.expires=new Date;f.setMilliseconds(f.getMilliseconds()+864e5*p)}return document.cookie=[o(e),"=",a(t),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.secure?"; secure":""].join("")}for(var l=e?void 0:{},g=document.cookie?document.cookie.split("; "):[],h=0,y=g.length;h<y;h++){var v=g[h].split("="),x=i(v.shift()),m=v.join("=");if(e===x){l=s(m,t);break}e||void 0===(m=s(m))||(l[x]=m)}return l},removeCookie:function(e,t){return n.cookie(e,"",n.extend({},t,{expires:-1})),!n.cookie(e)},hasCookie:function(e){var t;return void 0!==e&&(t=n.cookie(e),t&&"undefined"!=n.cookie(e))},url:{cache:null,param:function(e){var t,r,o=u.href.split("?")[1];if(o)return o=o.replace(/#.*/,""),null===(t=this.cache)&&(r=o.split("&"),t=this.cache={},n.each(r,function(e,n){var r=n.split("=");t[r[0]]=r[1]})),e?t[e]:t},findPid:function(){for(var t,n,r=["item","id-","/product/"],o="",i=0;i<r.length&&(n=new RegExp(r[i]+"[a-zA-Z0-9]+"),t=e.location.href.match(n),t&&t.length>0&&(o=t[0].replace(r[i],"")),!o);i++);return o}}});var d=n.extend({pId:n.url.findPid()||"",uuid:function(){return n.hasCookie("uuid")||n.cookie("uuid",n.generateUUID()),n.cookie("uuid")}(),pprd:n.generatePprdByPtag(),screen:n.device.screen,net:n.device.net,type:n.device.type(),version:n.device.appVersion()},function(){var e=n.cookie("session"),r=[];return e&&"undefined"!=e?(r=e.split(c.splitStr),n.checkSessionCookie(r)?(t-r[2])/1e3>=s.sessionExpiration?n.setSessionCookie():(r[2]=String(t),r[3]=String(+r[3]+1),n.cookie("session",r.join(c.splitStr))):n.setSessionCookie()):n.setSessionCookie(),r=n.cookie("session").split(c.splitStr),{sessionID:r[0],sessionStart:r[1],sessionEnd:r[2],sessionSeq:r[3]}}()),p={isReported:!1,parseImgUrl:function(e){var t=[];return n.each(e,function(e,n){t.push(e+"="+encodeURIComponent(n))}),s.img+"?"+t.join("&")},unique:function(){var e=(new Date).getTime()+"",t=0;return function(){return e+t++}}(),setCookies:function(e){n.cookie("pprd",e.pprd)},doReported:function(t){var n=p.parseImgUrl(t),r=e.imgLogData||(e.imgLogData={});r.uid=p.unique();var o=new Image;o.onload=o.onerror=function(){o.onload=o.onerror=null,o=null,delete r.uid},o.src=n+"&_="+r.uid},pvReported:function(t){p.isReported=!0,this.options=t=n.extend({reportedType:0,url:u.href,refer:document.referrer},d,t,e.G_REPORT_DEFAULT_PARAMS),p.setCookies(t),p.doReported(t)},clickReported:function(t){var r=t.pprd;n.device.appVersion().length>0&&(r="1"+r.substr(1)),t=n.extend({reportedType:1,uuid:n.cookie("uuid"),sessionID:function(){var e=n.cookie("session").split(c.splitStr);return n.isArray(e)?e[0]:""}(),url:u.href,refer:document.referrer,pprd:r,type:d.type},t,e.G_REPORT_DEFAULT_PARAMS),p.doReported(t)},generatePprdByPtag:function(e){return n.generatePprdByPtag(e)}},f=function(){function t(e){if(!r&&("onreadystatechange"!==e.type||"complete"===document.readyState)){for(var t=0;t<n.length;t++)n[t].call(document);r=!0,n=null}}var n=[],r=!1;return"complete"===document.readyState&&(r=!0),document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),document.addEventListener("readystatechange",t,!1),e.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",t),e.attachEvent("onload",t)),function(e){r?e.call(document):n.push(e)}}();f(function(){document.body.onclick=function(t){t=t||e.event;for(var n,r=t.target||t.srcElement;r&&r!==document.body;){if(n=r.getAttribute("pprd")){p.clickReported({pprd:n});break}r=r.parentNode}},setTimeout(function(){if(!p.isReported){var t=document.getElementById("STT-input");t&&0!=t.value?console.log("[STT]:存在 STT-input 后退不进行上报"):(p.pvReported(),t&&(t.value=e.location.href))}},500)}),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=p:"function"==typeof define&&define.amd&&define("STT",[],function(){return p}),"object"==typeof e&&"object"==typeof e.document&&(e.STT=p)}(window);