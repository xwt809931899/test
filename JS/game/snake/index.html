<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>è´ªé£Ÿè›‡</title>
    <script src="https://cdn.bootcss.com/phaser/2.6.2/phaser.min.js"></script>
    <style>
    #gameCanvas {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%,-50%);
    }
    #score {
        text-align: center;
        font-size: 70px;
        font-family: serif;

    }
    
    
    
    </style>
</head>
<body>
    <div id="score">0</div>
    <canvas id="gameCanvas" width="300" height="300"></canvas>
    
    <script>
        // x +-10
        let dx = 10, dy = 0;
        const GAME_SPPED = 100;
        function main () {
            setTimeout(function(){
                clearCanvas();
                advanceSnake()
                drawSnake();
                main();
            },GAME_SPPED)             //ç­‰åŒäºsetInterval
        }
        main();
        // snake é•¿èƒ– push
        // è¾¹ç•Œ
        let snake = [
        {x:150,y:150},
        {x:140,y:150},
        {x:130,y:150},
        {x:120,y:150},
        {x:110,y:150},
        ];




    const gameCanvas = document.getElementById('gameCanvas');
    //ç»˜åˆ¶ä¸Šä¸‹æ–‡ç¯å¢ƒ apiåœ¨ctxä¸Š
    const ctx = gameCanvas.getContext('2d');
   
//    clearCanvas();
   

   function clearCanvas () {
    ctx.fillStyle = 'white';
    ctx.strokeStyle = 'black';
    ctx.fillRect(0,0,gameCanvas.width,gameCanvas.height);
    ctx.strokeRect(0,0,gameCanvas.width,gameCanvas.height);
   }    

    //åˆå§‹ç»˜åˆ¶è›‡
    // drawSnake();
    // dx = 10;
    // dy = 0;
    // setInterval(() => {
        // clearCanvas();
        // advanceSnake();
        // drawSnake();

    // }, 100);


    function drawSnake () {
        snake.forEach(drawSnakePart);
    }

    function drawSnakePart (part) {
        ctx.fillStyle = 'lightgreen';
        ctx.strokeStyle = 'darkgreen';
        ctx.fillRect(part.x,part.y,10,10);
        ctx.strokeRect(part.x,part.y,10,10);

    }

    function advanceSnake() {
        
        // canvas ä¸Šä¸€æ¬¡çš„åŸºç¡€ä¸Šæ›´ç»˜ä¸‹ä¸€æ¬¡
        // å…¨åŠ¨å—? æœ€å‰é¢åŠ ä¸€ä¸ª ç¬¬ä¸€ä¸ªå‰è¿›ä¸€ä¸ª,æœ€åä¸€ä¸ªç§»é™¤
        const head = {x: snake[0].x + dx,y: snake[0].y + dy };
        snake.unshift(head);
        snake.pop();
    }
        // è›‡ğŸ èº«å­æ˜¯å‡ ä¸ªrect ä½ç½® åæ ‡
    function changeDirection (event) {
        const LEFT_KEY = 37;
        const RIGHT_KEY = 39;
        const UP_KEY = 38;
        const DOWN_KEY = 40;
        const keyPressed = event.keyCode;
        const goingRight = dx === 10;
        const goingDown = dy === 10;
        const goingLeft = dx === -10;
        const goingUp = dy === -10;

        if(keyPressed === LEFT_KEY && !goingRight ) {
            dx = -10;
            dy = 0;
        }
        else if(keyPressed ===RIGHT_KEY && !goingLeft) {
            dx = 10;
            dy = 0;
        }
        else if(keyPressed === UP_KEY && !goingDown) {
            dx = 0;
            dy = -10;
        }
        else if(keyPressed === DOWN_KEY && !goingUp) {
            dx = 0;
            dy = 10;
        }

        // clearCanvas();
        // advanceSnake();
        // drawSnake();

       
    }
        document.addEventListener('keydown',changeDirection);
    
    </script>
</body>
</html>